<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
    <title>Document</title>
</head>
<body style="padding: 5%; background-color: beige;">
    <form class="row g-3" 
    name="submit-to-google-sheet">
        <div class="col-md-4">
          <label for="validationDefault01" class="form-label">First name</label>
          <input type="text" class="form-control" name="firstName" id="firstName" value="Mark" required>
        </div>
        <div class="col-md-4">
          <label for="validationDefault02" class="form-label">Last name</label>
          <input type="text" class="form-control" name="lastName" id="lastName" value="Otto" required>
        </div>
        <div class="col-12">
          <button class="btn btn-primary" type="submit">Submit form</button>
        </div>
      </form>

    <script>

    const proxyUrl = 'https://cors-anywhere.herokuapp.com/';
    const targetUrl = 'https://script.google.com/macros/s/AKfycbySmGRBGvkN1-8fHR3v3BPmqHAvA2KPzelsE9mNC4gbKVbbtdE-SUReHEZ7DLGbCDlXPA/exec';

    fetch(proxyUrl + targetUrl)
        .then(response => response.json())
        .then(data => console.log(data))
        .catch(error => console.error('Помилка:', error));


        const scriptURL = 'https://script.google.com/macros/s/AKfycbySmGRBGvkN1-8fHR3v3BPmqHAvA2KPzelsE9mNC4gbKVbbtdE-SUReHEZ7DLGbCDlXPA/exec'
        const form = document.forms['submit-to-google-sheet']
      
        form.addEventListener('submit', e => {
          e.preventDefault()
          fetch(scriptURL, { method: 'POST', body: new FormData(form)})
            .then(response => console.log('Success!', response))
            .catch(error => console.error('Error!', error.message))
        })
      </script>
</body>
</html>